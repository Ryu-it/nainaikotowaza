<%= render "shared/flash_message" %>

<div class="min-h-screen bg-gradient-to-b from-slate-900 via-rose-950/70 to-slate-950 py-12 px-6">
  <div class="max-w-4xl mx-auto space-y-10">
    <!-- プロフィールカード -->
    <section class="bg-white border border-rose-100 rounded-2xl shadow-sm px-8 py-10">
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-6">
        <div class="space-y-2">
          <p class="text-sm text-gray-500">ユーザー名</p>
          <h1 class="text-3xl font-semibold text-gray-900"><%= @user.name %></h1>
          <p class="text-sm text-gray-500">登録日 <%= @user.created_at.strftime("%Y/%m/%d") %></p>
        </div>

        <% if current_user == @user %>
          <%= link_to "プロフィールを編集",
                      edit_user_registration_path,
                      class: "inline-block rounded-xl border border-rose-200 bg-rose-50 px-6 py-2 text-sm font-medium text-rose-700 hover:bg-rose-100 transition" %>
        <% elsif current_user.present? %>
          <% if current_user.following?(@user) %>
            <%= link_to "フォローを外す",
                        user_follows_path(@user),
                        data: { turbo_method: :delete },
                        class: "inline-block rounded-xl border border-gray-400 bg-gray-200 px-6 py-2 text-sm font-medium text-gray-800 hover:bg-gray-300 transition" %>
          <% else %>
            <%= link_to "フォローする",
                        user_follows_path(@user),
                        data: { turbo_method: :post },
                        class: "inline-block rounded-xl border border-blue-800 bg-blue-600 px-6 py-2 text-sm font-medium text-white hover:bg-blue-700 transition" %>
          <% end %>
        <% end %>
      </div>

      <div class="mt-8 grid grid-cols-1 sm:grid-cols-2 gap-4 sm:max-w-md">
        <%= link_to "#",
                    class: "flex flex-col justify-between rounded-xl border border-rose-200 bg-rose-50 px-6 py-4 hover:bg-rose-100 transition" do %>
          <span class="text-xs text-gray-500">フォロー中</span>
          <span class="mt-1 text-2xl font-semibold text-gray-900"><%= @following_count %></span>
        <% end %>

        <%= link_to "#",
                    class: "flex flex-col justify-between rounded-xl border border-rose-200 bg-rose-50 px-6 py-4 hover:bg-rose-100 transition" do %>
          <span class="text-xs text-gray-500">フォロワー</span>
          <span class="mt-1 text-2xl font-semibold text-gray-900"><%= @followers_count %></span>
        <% end %>
      </div>
    </section>

    <!-- ことわざリスト -->
    <section class="bg-white border border-rose-100 rounded-2xl shadow-sm px-8 py-10">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-xl font-semibold text-gray-900">作成したことわざ</h2>
        <span class="text-sm text-gray-500">全<%= @proverbs.size %>件</span>
      </div>

      <% if @proverbs.any? %>
        <div class="grid gap-5 sm:grid-cols-2">
          <% @proverbs.each do |proverb| %>
            <div class="rounded-xl border border-gray-200 bg-white px-6 py-5 hover:border-rose-300 hover:shadow transition">
              <%= link_to proverb_path(proverb), class: "block" do %>
                <p class="text-xs text-gray-500"><%= proverb.created_at.strftime("%Y/%m/%d") %></p>
                <p class="mt-2 text-lg font-medium text-gray-900"><%= proverb.title %></p>
                <% if proverb.meaning.present? %>
                  <p class="mt-3 text-sm text-gray-600"><%= truncate(proverb.meaning, length: 60) %></p>
                <% end %>
              <% end %>

              <% if current_user == @user %>
                <div class="mt-4 flex flex-wrap gap-3">
                  <%= link_to "編集",
                              edit_proverb_path(proverb),
                              class: "inline-flex items-center justify-center rounded-lg border border-blue-700 bg-blue-600 px-4 py-1.5 text-sm font-medium text-white hover:bg-blue-700 transition" %>
                  <%= link_to "削除",
                              proverb_path(proverb),
                              data: { turbo_method: :delete, turbo_confirm: "本当に削除しますか？" },
                              class: "inline-flex items-center justify-center rounded-lg border border-gray-400 bg-gray-200 px-4 py-1.5 text-sm font-medium text-gray-800 hover:bg-gray-300 transition" %>
                </div>
              <% end %>
            </div>
          <% end %>
        </div>
      <% else %>
        <p class="py-12 text-center text-gray-500">まだ作成したことわざはありません。</p>
      <% end %>
    </section>
  </div>
</div>
